<?php return array (
  'preserve_keys' => true,
  'update_object' => true,
  'vehicle_package' => 'transport',
  'vehicle_class' => 'xPDOObjectVehicle',
  'guid' => '3af9300a50c1be7c8aa60eccb2811533',
  'package' => 'modx',
  'class' => 'modSnippet',
  'signature' => '1b5c2ffb0fcff160c39579088da36dd2',
  'native_key' => 62,
  'object' => '{"id":62,"source":1,"property_preprocess":0,"name":"pdoArchive","description":"","editor_type":0,"category":12,"cache_type":0,"snippet":"$modx->lexicon->load(\'pdotools:pdoarchive\');\\n\\n\\/** @var array $scriptProperties *\\/\\n$tplWrapper = $modx->getOption(\'tplWrapper\', $scriptProperties);\\n$tplYear = $modx->getOption(\'tplYear\', $scriptProperties);\\n$tplMonth = $modx->getOption(\'tplMonth\', $scriptProperties);\\n$tplDay = $modx->getOption(\'tplDay\', $scriptProperties);\\n$tpl = $modx->getOption(\'tpl\', $scriptProperties);\\n$dateField = $modx->getOption(\'dateField\', $scriptProperties, \'createdon\', true);\\n$dateFormat = $modx->getOption(\'dateFormat\', $scriptProperties, \'H:i\', true);\\n$outputSeparator = $modx->getOption(\'outputSeparator\', $scriptProperties, \\"\\\\n\\");\\n\\n\\/\\/ Adding extra parameters into special place so we can put them in a results\\n\\/** @var modSnippet $snippet *\\/\\n$additionalPlaceholders = $properties = array();\\nif (isset($this) && $this instanceof modSnippet) {\\n    $properties = $this->get(\'properties\');\\n} elseif ($snippet = $modx->getObject(\'modSnippet\', array(\'name\' => \'pdoResources\'))) {\\n    $properties = $snippet->get(\'properties\');\\n}\\nif (!empty($properties)) {\\n    foreach ($scriptProperties as $k => $v) {\\n        if (!isset($properties[$k])) {\\n            $additionalPlaceholders[$k] = $v;\\n        }\\n    }\\n}\\n$scriptProperties[\'additionalPlaceholders\'] = $additionalPlaceholders;\\nif (isset($parents) && $parents === \'\') {\\n    $scriptProperties[\'parents\'] = $modx->resource->id;\\n}\\n$scriptProperties[\'return\'] = \'data\';\\n\\/** @var pdoFetch $pdoFetch *\\/\\n$fqn = $modx->getOption(\'pdoFetch.class\', null, \'pdotools.pdofetch\', true);\\n$path = $modx->getOption(\'pdofetch_class_path\', null, MODX_CORE_PATH . \'components\\/pdotools\\/model\\/\', true);\\nif ($pdoClass = $modx->loadClass($fqn, $path, false, true)) {\\n    $pdoFetch = new $pdoClass($modx, $scriptProperties);\\n} else {\\n    return false;\\n}\\n$pdoFetch->addTime(\'pdoTools loaded\');\\n$rows = $pdoFetch->run();\\n\\n\\/\\/ Process rows\\n$tree = array();\\nforeach ($rows as $row) {\\n    $tmp = $row[$dateField];\\n    if (!is_numeric($tmp)) {\\n        $tmp = strtotime($tmp);\\n    }\\n    $year = date(\'Y\', $tmp);\\n    $month = date(\'m\', $tmp);\\n    $day = date(\'d\', $tmp);\\n    $tree[$year][$month][$day][] = $row;\\n}\\n\\n$output = \'\';\\nforeach ($tree as $year => $months) {\\n    $rows_year = \'\';\\n    $count_year = 0;\\n\\n    foreach ($months as $month => $days) {\\n        $rows_month = \'\';\\n        $count_month = 0;\\n\\n        foreach ($days as $day => $resources) {\\n            $rows_day = array();\\n            $count_day = 0;\\n            $idx = 1;\\n\\n            foreach ($resources as $resource) {\\n                $resource[\'day\'] = $day;\\n                $resource[\'month\'] = $month;\\n                $resource[\'year\'] = $year;\\n                $resource[\'date\'] = strftime($dateFormat, $resource[$dateField]);\\n                $resource[\'idx\'] = $idx++;\\n                $resource[\'menutitle\'] = !empty($resource[\'menutitle\'])\\n                    ? $resource[\'menutitle\']\\n                    : $resource[\'pagetitle\'];\\n                \\/\\/ Add placeholder [[+link]] if specified\\n                if (!empty($scriptProperties[\'useWeblinkUrl\'])) {\\n                    if (!isset($resource[\'context_key\'])) {\\n                        $resource[\'context_key\'] = \'\';\\n                    }\\n                    if (isset($resource[\'class_key\']) && ($resource[\'class_key\'] == \'modWebLink\')) {\\n                        $resource[\'link\'] = isset($resource[\'content\']) && is_numeric(trim($resource[\'content\'], \'[]~ \'))\\n                            ? $pdoFetch->makeUrl(intval(trim($resource[\'content\'], \'[]~ \')), $resource)\\n                            : (isset($resource[\'content\']) ? $resource[\'content\'] : \'\');\\n                    } else {\\n                        $resource[\'link\'] = $pdoFetch->makeUrl($resource[\'id\'], $resource);\\n                    }\\n                } else {\\n                    $resource[\'link\'] = \'\';\\n                }\\n                $tpl = $pdoFetch->defineChunk($resource);\\n                $rows_day[] = $pdoFetch->getChunk($tpl, $resource);\\n                $count_year++;\\n                $count_month++;\\n                $count_day++;\\n            }\\n\\n            $rows_month .= !empty($tplDay)\\n                ? $pdoFetch->getChunk($tplDay, array(\\n                    \'day\' => $day,\\n                    \'month\' => $month,\\n                    \'year\' => $year,\\n                    \'count\' => $count_day,\\n                    \'wrapper\' => implode($outputSeparator, $rows_day),\\n                ), $pdoFetch->config[\'fastMode\'])\\n                : implode($outputSeparator, $rows_day);\\n        }\\n\\n        $rows_year .= !empty($tplMonth)\\n            ? $pdoFetch->getChunk($tplMonth, array(\\n                \'month\' => $month,\\n                \'month_name\' => $modx->lexicon(\'pdoarchive_month_\' . $month),\\n                \'year\' => $year,\\n                \'count\' => $count_month,\\n                \'wrapper\' => $rows_month,\\n            ), $pdoFetch->config[\'fastMode\'])\\n            : $rows_month;\\n    }\\n\\n    $output .= !empty($tplYear)\\n        ? $pdoFetch->getChunk($tplYear, array(\\n            \'year\' => $year,\\n            \'count\' => $count_year,\\n            \'wrapper\' => $rows_year,\\n        ), $pdoFetch->config[\'fastMode\'])\\n        : $rows_year;\\n}\\n$pdoFetch->addTime(\'Rows processed\');\\n\\n\\/\\/ Return output\\nif (!empty($tplWrapper) && (!empty($wrapIfEmpty) || !empty($output))) {\\n    $output = $pdoFetch->getChunk(\\n        $tplWrapper,\\n        array_merge($additionalPlaceholders, array(\'output\' => $output)),\\n        $pdoFetch->config[\'fastMode\']\\n    );\\n    $pdoFetch->addTime(\'Rows wrapped\');\\n}\\n\\nif ($modx->user->hasSessionContext(\'mgr\') && !empty($showLog)) {\\n    $output .= \'<pre class=\\"pdoArchiveLog\\">\' . print_r($pdoFetch->getTime(), 1) . \'<\\/pre>\';\\n}\\n\\nif (!empty($toPlaceholder)) {\\n    $modx->setPlaceholder($toPlaceholder, $output);\\n} else {\\n    return $output;\\n}","locked":0,"properties":"a:36:{s:3:\\"tpl\\";a:7:{s:4:\\"name\\";s:3:\\"tpl\\";s:4:\\"desc\\";s:17:\\"pdotools_prop_tpl\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:65:\\"@INLINE <li>[[+date]] <a href=\\"[[+link]]\\">[[+menutitle]]<\\/a><\\/li>\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"tplYear\\";a:7:{s:4:\\"name\\";s:7:\\"tplYear\\";s:4:\\"desc\\";s:21:\\"pdotools_prop_tplYear\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:71:\\"@INLINE <h3>[[+year]] <sup>([[+count]])<\\/sup><\\/h3><ul>[[+wrapper]]<\\/ul>\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:8:\\"tplMonth\\";a:7:{s:4:\\"name\\";s:8:\\"tplMonth\\";s:4:\\"desc\\";s:22:\\"pdotools_prop_tplMonth\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:86:\\"@INLINE <li><h4>[[+month_name]] <sup>([[+count]])<\\/sup><\\/h4><ul>[[+wrapper]]<\\/ul><\\/li>\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"tplDay\\";a:7:{s:4:\\"name\\";s:6:\\"tplDay\\";s:4:\\"desc\\";s:20:\\"pdotools_prop_tplDay\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:79:\\"@INLINE <li><h5>[[+day]] <sup>([[+count]])<\\/sup><\\/h5><ul>[[+wrapper]]<\\/ul><\\/li>\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"tplWrapper\\";a:7:{s:4:\\"name\\";s:10:\\"tplWrapper\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_tplWrapper\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:11:\\"wrapIfEmpty\\";a:7:{s:4:\\"name\\";s:11:\\"wrapIfEmpty\\";s:4:\\"desc\\";s:25:\\"pdotools_prop_wrapIfEmpty\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:9:\\"dateField\\";a:7:{s:4:\\"name\\";s:9:\\"dateField\\";s:4:\\"desc\\";s:23:\\"pdotools_prop_dateField\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:9:\\"createdon\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"dateFormat\\";a:7:{s:4:\\"name\\";s:10:\\"dateFormat\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_dateFormat\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:5:\\"%H:%M\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"showLog\\";a:7:{s:4:\\"name\\";s:7:\\"showLog\\";s:4:\\"desc\\";s:21:\\"pdotools_prop_showLog\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"sortby\\";a:7:{s:4:\\"name\\";s:6:\\"sortby\\";s:4:\\"desc\\";s:20:\\"pdotools_prop_sortby\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:9:\\"createdon\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:8:\\"sortbyTV\\";a:7:{s:4:\\"name\\";s:8:\\"sortbyTV\\";s:4:\\"desc\\";s:22:\\"pdotools_prop_sortbyTV\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:12:\\"sortbyTVType\\";a:7:{s:4:\\"name\\";s:12:\\"sortbyTVType\\";s:4:\\"desc\\";s:26:\\"pdotools_prop_sortbyTVType\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"sortdir\\";a:7:{s:4:\\"name\\";s:7:\\"sortdir\\";s:4:\\"desc\\";s:21:\\"pdotools_prop_sortdir\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:3:\\"ASC\\";s:5:\\"value\\";s:3:\\"ASC\\";}i:1;a:2:{s:4:\\"text\\";s:4:\\"DESC\\";s:5:\\"value\\";s:4:\\"DESC\\";}}s:5:\\"value\\";s:4:\\"DESC\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:9:\\"sortdirTV\\";a:7:{s:4:\\"name\\";s:9:\\"sortdirTV\\";s:4:\\"desc\\";s:23:\\"pdotools_prop_sortdirTV\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:3:\\"ASC\\";s:5:\\"value\\";s:3:\\"ASC\\";}i:1;a:2:{s:4:\\"text\\";s:4:\\"DESC\\";s:5:\\"value\\";s:4:\\"DESC\\";}}s:5:\\"value\\";s:3:\\"ASC\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:5:\\"limit\\";a:7:{s:4:\\"name\\";s:5:\\"limit\\";s:4:\\"desc\\";s:19:\\"pdotools_prop_limit\\";s:4:\\"type\\";s:11:\\"numberfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";i:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"offset\\";a:7:{s:4:\\"name\\";s:6:\\"offset\\";s:4:\\"desc\\";s:20:\\"pdotools_prop_offset\\";s:4:\\"type\\";s:11:\\"numberfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";i:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:5:\\"depth\\";a:7:{s:4:\\"name\\";s:5:\\"depth\\";s:4:\\"desc\\";s:19:\\"pdotools_prop_depth\\";s:4:\\"type\\";s:11:\\"numberfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";i:10;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:15:\\"outputSeparator\\";a:7:{s:4:\\"name\\";s:15:\\"outputSeparator\\";s:4:\\"desc\\";s:29:\\"pdotools_prop_outputSeparator\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:1:\\"\\n\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:13:\\"toPlaceholder\\";a:7:{s:4:\\"name\\";s:13:\\"toPlaceholder\\";s:4:\\"desc\\";s:27:\\"pdotools_prop_toPlaceholder\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"parents\\";a:7:{s:4:\\"name\\";s:7:\\"parents\\";s:4:\\"desc\\";s:21:\\"pdotools_prop_parents\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:14:\\"includeContent\\";a:7:{s:4:\\"name\\";s:14:\\"includeContent\\";s:4:\\"desc\\";s:28:\\"pdotools_prop_includeContent\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"includeTVs\\";a:7:{s:4:\\"name\\";s:10:\\"includeTVs\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_includeTVs\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"prepareTVs\\";a:7:{s:4:\\"name\\";s:10:\\"prepareTVs\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_prepareTVs\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:1:\\"1\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"processTVs\\";a:7:{s:4:\\"name\\";s:10:\\"processTVs\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_processTVs\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:8:\\"tvPrefix\\";a:7:{s:4:\\"name\\";s:8:\\"tvPrefix\\";s:4:\\"desc\\";s:22:\\"pdotools_prop_tvPrefix\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:3:\\"tv.\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:5:\\"where\\";a:7:{s:4:\\"name\\";s:5:\\"where\\";s:4:\\"desc\\";s:19:\\"pdotools_prop_where\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:15:\\"showUnpublished\\";a:7:{s:4:\\"name\\";s:15:\\"showUnpublished\\";s:4:\\"desc\\";s:29:\\"pdotools_prop_showUnpublished\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:11:\\"showDeleted\\";a:7:{s:4:\\"name\\";s:11:\\"showDeleted\\";s:4:\\"desc\\";s:25:\\"pdotools_prop_showDeleted\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"showHidden\\";a:7:{s:4:\\"name\\";s:10:\\"showHidden\\";s:4:\\"desc\\";s:24:\\"pdotools_prop_showHidden\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:1;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:14:\\"hideContainers\\";a:7:{s:4:\\"name\\";s:14:\\"hideContainers\\";s:4:\\"desc\\";s:28:\\"pdotools_prop_hideContainers\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:0;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"context\\";a:7:{s:4:\\"name\\";s:7:\\"context\\";s:4:\\"desc\\";s:21:\\"pdotools_prop_context\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:8:\\"totalVar\\";a:7:{s:4:\\"name\\";s:8:\\"totalVar\\";s:4:\\"desc\\";s:22:\\"pdotools_prop_totalVar\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:5:\\"total\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:9:\\"resources\\";a:7:{s:4:\\"name\\";s:9:\\"resources\\";s:4:\\"desc\\";s:23:\\"pdotools_prop_resources\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"select\\";a:7:{s:4:\\"name\\";s:6:\\"select\\";s:4:\\"desc\\";s:20:\\"pdotools_prop_select\\";s:4:\\"type\\";s:8:\\"textarea\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"scheme\\";a:7:{s:4:\\"name\\";s:6:\\"scheme\\";s:4:\\"desc\\";s:20:\\"pdotools_prop_scheme\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:6:{i:0;a:2:{s:5:\\"value\\";s:0:\\"\\";s:4:\\"text\\";s:14:\\"System default\\";}i:1;a:2:{s:5:\\"value\\";i:-1;s:4:\\"text\\";s:25:\\"-1 (relative to site_url)\\";}i:2;a:2:{s:5:\\"value\\";s:4:\\"full\\";s:4:\\"text\\";s:40:\\"full (absolute, prepended with site_url)\\";}i:3;a:2:{s:5:\\"value\\";s:3:\\"abs\\";s:4:\\"text\\";s:39:\\"abs (absolute, prepended with base_url)\\";}i:4;a:2:{s:5:\\"value\\";s:4:\\"http\\";s:4:\\"text\\";s:38:\\"http (absolute, forced to http scheme)\\";}i:5;a:2:{s:5:\\"value\\";s:5:\\"https\\";s:4:\\"text\\";s:40:\\"https (absolute, forced to https scheme)\\";}}s:5:\\"value\\";s:0:\\"\\";s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}s:13:\\"useWeblinkUrl\\";a:7:{s:4:\\"name\\";s:13:\\"useWeblinkUrl\\";s:4:\\"desc\\";s:27:\\"pdotools_prop_useWeblinkUrl\\";s:4:\\"type\\";s:13:\\"combo-boolean\\";s:7:\\"options\\";a:0:{}s:5:\\"value\\";b:1;s:7:\\"lexicon\\";s:19:\\"pdotools:properties\\";s:4:\\"area\\";s:0:\\"\\";}}","moduleguid":"","static":0,"static_file":"core\\/components\\/pdotools\\/elements\\/snippets\\/snippet.pdoarchive.php","content":"$modx->lexicon->load(\'pdotools:pdoarchive\');\\n\\n\\/** @var array $scriptProperties *\\/\\n$tplWrapper = $modx->getOption(\'tplWrapper\', $scriptProperties);\\n$tplYear = $modx->getOption(\'tplYear\', $scriptProperties);\\n$tplMonth = $modx->getOption(\'tplMonth\', $scriptProperties);\\n$tplDay = $modx->getOption(\'tplDay\', $scriptProperties);\\n$tpl = $modx->getOption(\'tpl\', $scriptProperties);\\n$dateField = $modx->getOption(\'dateField\', $scriptProperties, \'createdon\', true);\\n$dateFormat = $modx->getOption(\'dateFormat\', $scriptProperties, \'H:i\', true);\\n$outputSeparator = $modx->getOption(\'outputSeparator\', $scriptProperties, \\"\\\\n\\");\\n\\n\\/\\/ Adding extra parameters into special place so we can put them in a results\\n\\/** @var modSnippet $snippet *\\/\\n$additionalPlaceholders = $properties = array();\\nif (isset($this) && $this instanceof modSnippet) {\\n    $properties = $this->get(\'properties\');\\n} elseif ($snippet = $modx->getObject(\'modSnippet\', array(\'name\' => \'pdoResources\'))) {\\n    $properties = $snippet->get(\'properties\');\\n}\\nif (!empty($properties)) {\\n    foreach ($scriptProperties as $k => $v) {\\n        if (!isset($properties[$k])) {\\n            $additionalPlaceholders[$k] = $v;\\n        }\\n    }\\n}\\n$scriptProperties[\'additionalPlaceholders\'] = $additionalPlaceholders;\\nif (isset($parents) && $parents === \'\') {\\n    $scriptProperties[\'parents\'] = $modx->resource->id;\\n}\\n$scriptProperties[\'return\'] = \'data\';\\n\\/** @var pdoFetch $pdoFetch *\\/\\n$fqn = $modx->getOption(\'pdoFetch.class\', null, \'pdotools.pdofetch\', true);\\n$path = $modx->getOption(\'pdofetch_class_path\', null, MODX_CORE_PATH . \'components\\/pdotools\\/model\\/\', true);\\nif ($pdoClass = $modx->loadClass($fqn, $path, false, true)) {\\n    $pdoFetch = new $pdoClass($modx, $scriptProperties);\\n} else {\\n    return false;\\n}\\n$pdoFetch->addTime(\'pdoTools loaded\');\\n$rows = $pdoFetch->run();\\n\\n\\/\\/ Process rows\\n$tree = array();\\nforeach ($rows as $row) {\\n    $tmp = $row[$dateField];\\n    if (!is_numeric($tmp)) {\\n        $tmp = strtotime($tmp);\\n    }\\n    $year = date(\'Y\', $tmp);\\n    $month = date(\'m\', $tmp);\\n    $day = date(\'d\', $tmp);\\n    $tree[$year][$month][$day][] = $row;\\n}\\n\\n$output = \'\';\\nforeach ($tree as $year => $months) {\\n    $rows_year = \'\';\\n    $count_year = 0;\\n\\n    foreach ($months as $month => $days) {\\n        $rows_month = \'\';\\n        $count_month = 0;\\n\\n        foreach ($days as $day => $resources) {\\n            $rows_day = array();\\n            $count_day = 0;\\n            $idx = 1;\\n\\n            foreach ($resources as $resource) {\\n                $resource[\'day\'] = $day;\\n                $resource[\'month\'] = $month;\\n                $resource[\'year\'] = $year;\\n                $resource[\'date\'] = strftime($dateFormat, $resource[$dateField]);\\n                $resource[\'idx\'] = $idx++;\\n                $resource[\'menutitle\'] = !empty($resource[\'menutitle\'])\\n                    ? $resource[\'menutitle\']\\n                    : $resource[\'pagetitle\'];\\n                \\/\\/ Add placeholder [[+link]] if specified\\n                if (!empty($scriptProperties[\'useWeblinkUrl\'])) {\\n                    if (!isset($resource[\'context_key\'])) {\\n                        $resource[\'context_key\'] = \'\';\\n                    }\\n                    if (isset($resource[\'class_key\']) && ($resource[\'class_key\'] == \'modWebLink\')) {\\n                        $resource[\'link\'] = isset($resource[\'content\']) && is_numeric(trim($resource[\'content\'], \'[]~ \'))\\n                            ? $pdoFetch->makeUrl(intval(trim($resource[\'content\'], \'[]~ \')), $resource)\\n                            : (isset($resource[\'content\']) ? $resource[\'content\'] : \'\');\\n                    } else {\\n                        $resource[\'link\'] = $pdoFetch->makeUrl($resource[\'id\'], $resource);\\n                    }\\n                } else {\\n                    $resource[\'link\'] = \'\';\\n                }\\n                $tpl = $pdoFetch->defineChunk($resource);\\n                $rows_day[] = $pdoFetch->getChunk($tpl, $resource);\\n                $count_year++;\\n                $count_month++;\\n                $count_day++;\\n            }\\n\\n            $rows_month .= !empty($tplDay)\\n                ? $pdoFetch->getChunk($tplDay, array(\\n                    \'day\' => $day,\\n                    \'month\' => $month,\\n                    \'year\' => $year,\\n                    \'count\' => $count_day,\\n                    \'wrapper\' => implode($outputSeparator, $rows_day),\\n                ), $pdoFetch->config[\'fastMode\'])\\n                : implode($outputSeparator, $rows_day);\\n        }\\n\\n        $rows_year .= !empty($tplMonth)\\n            ? $pdoFetch->getChunk($tplMonth, array(\\n                \'month\' => $month,\\n                \'month_name\' => $modx->lexicon(\'pdoarchive_month_\' . $month),\\n                \'year\' => $year,\\n                \'count\' => $count_month,\\n                \'wrapper\' => $rows_month,\\n            ), $pdoFetch->config[\'fastMode\'])\\n            : $rows_month;\\n    }\\n\\n    $output .= !empty($tplYear)\\n        ? $pdoFetch->getChunk($tplYear, array(\\n            \'year\' => $year,\\n            \'count\' => $count_year,\\n            \'wrapper\' => $rows_year,\\n        ), $pdoFetch->config[\'fastMode\'])\\n        : $rows_year;\\n}\\n$pdoFetch->addTime(\'Rows processed\');\\n\\n\\/\\/ Return output\\nif (!empty($tplWrapper) && (!empty($wrapIfEmpty) || !empty($output))) {\\n    $output = $pdoFetch->getChunk(\\n        $tplWrapper,\\n        array_merge($additionalPlaceholders, array(\'output\' => $output)),\\n        $pdoFetch->config[\'fastMode\']\\n    );\\n    $pdoFetch->addTime(\'Rows wrapped\');\\n}\\n\\nif ($modx->user->hasSessionContext(\'mgr\') && !empty($showLog)) {\\n    $output .= \'<pre class=\\"pdoArchiveLog\\">\' . print_r($pdoFetch->getTime(), 1) . \'<\\/pre>\';\\n}\\n\\nif (!empty($toPlaceholder)) {\\n    $modx->setPlaceholder($toPlaceholder, $output);\\n} else {\\n    return $output;\\n}"}',
);